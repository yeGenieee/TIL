# 2023-06-07

### 📌 학습 계획
- 운영체제
  - 역할
  - 커널
  - 이중모드
  - 시스템 호출

### ✏️ TIL
- 운영체제
  - 역할
  - 커널
  - 이중모드
  - 시스템 호출


## 운영체제
- 모든 프로그램은 실행되기 위해서 반드시 자원이 필요한데,
- 운영체제 : 실행할 프로그램에 필요한 자원을 할당하고, 프로그램이 올바르게 실행되도록 돕는 특별한 프로그램
- 운영체제도 프로그램이어서 메모리에 적재되어야 한다
  - 그런데, 운영체제는 특별한 프로그램이어서 메모리 내 `커널 영역(kernel space)` 이라는 공간에 따로 적재되어 실행된다
- `사용자 영역 (user space)` : 커널 영역이 아닌 사용자가 이용하는 응용 프로그램이 적재되는 영역

### 운영체제가 하는 역할?
- 커널 영역에 적재되어서 사용자 영역에 적재된 프로그램들에게 **자원을 할당**하고, 올바르게 실행되도록 하는 역할을 한다
- 즉, 실행할 프로그램을 메모리에 적재하고, 더 이상 실행되지 않는 프로그램을 메모리에서 제거하면서 지속적으로 **메모리 자원을 관리**하는 역할을 한다
- ⭐️ 결론 : 응용 프로그램과 하드웨어 사이에서 응용 프로그램에 필요한 자원(ex) CPU, 메모리, 하드디스크 등..)을 할당하고, 응용 프로그램이 올바르게 실행되도록 관리하는 역할을 한다

### 왜 운영체제가 중요할까?
- 운영체제가 없으면, 하드웨어 조작하는 코드를 개발자가 다 개발해야하는데... -> 비효율적이다

## 커널 (kernel)
- 운영체제의 핵심 서비스를 담당하는 부분
  - 핵심 서비스?
    - 자원에 접근하고 조작하는 기능, 프로그램이 올바르게 실행되게 하는 기능...

## 이중모드와 시스템 호출
- 운영체제는 사용자가 실행하는 애플리케이션이 하드웨어 자원에 직접 접근하는 것을 방지하여 자원을 보호한다
  - 왜? 
    - 애플리케이션 각각 자원에 접근해서 마음대로 조작할 수 있으면 관리가 안되기 때문
- 이렇게 자원을 보호하는 행위가 이중 모드로써 구현된다

### 이중 모드 (Dual mode)
- CPU가 명령어를 실행하는 모드를 크게 `사용자 모드`와 `커널 모드`로 구분하는 방식 (운영체제 서비스를 제공받을 수 있는가 아닌가 (커널 영역의 코드를 실행할 수 있는가 아닌가))
- CPU는 명령어를 사용자 모드로써 실행할 수 있고, 커널 모드로써 실행할 수 있다

### 1. 사용자 모드 (User mode)
- 운영체제 서비스를 제공받을 수 없는 실행 모드
- 커널 영역의 코드를 실행할 수 없는 모드이다
- 일반적인 애플리케이션은 기본적으로 사용자모드로 실행되어서, 자원에 접근할 수 없다

### 2. 커널 모드 (Kernel mode)
- 운영체제 서비스를 제공받을 수 있는 실행 모드
- 커널 영역의 코드를 실행할 수 있는 모드이다
- CPU가 커널 모드로 명령어를 실행하면 자원에 접근하는 명령어를 비롯한 모든 명령어를 실행할 수 있다
  
📌 사용자 모드로 실행되는 프로그램이 자원에 접근하는 운영체제 서비스를 제공받으려면?
- 운영체제에 요청을 보내서 커널 모드로 전환되어야 한다
  - 요청 = 시스템 호출 (system call)
    - 결국 시스템 호출도 interrupt이다 (소프트웨어 인터럽트)

### CPU가 시스템 호출을 처리하는 순서
1. 시스템 호출을 발생시키는 명령어가 실행되면, CPU는 지금까지의 작업을 백업한다
2. 커널 영역 내에 시스템 호출을 수행하는 코드 (인터럽트 서비스 루틴) 을 실행한다
3. 자원에 접근이 끝났다면, 다시 기존에 실행하던 응용 프로그램으로 복귀해서 실행을 계속한다

## 운영체제의 핵심 서비스
1. 프로세스 관리
2. 자원 접근 및 할당
3. 파일 시스템 관리


### 1. 프로세스 관리
- 프로세스 : 실행중인 프로그램
- 일반적으로 하나의 CPU는 한 번에 하나의 프로세스만 실행할 수 있어서 CPU는 프로세스들을 번갈아 가면서 실행한다
- 그래서, 운영체제는 다양한 프로세스를 효율적으로 관리하고 실행한다
  - 🧐 프로세스 동기화
  - 🧐 교착상태

### 2. 자원 접근 및 할당


### 3. 파일 시스템 관리

## Reference
- 강민철, 『혼자 공부하는 컴퓨터 구조+운영체제』, 한빛미디어(2022), p.260 ~ p.281
