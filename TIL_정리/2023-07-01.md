# 2023-07-01 TIL
### ğŸ“Œ í•™ìŠµ ê³„íš
- Singleton 

### âœï¸ TIL
- Singleton

## Singleton Registry
- ê¸°ì¡´ì˜ ì˜¤ë¸Œì íŠ¸ íŒ©í† ë¦¬ `DaoFactory` ì™€ ìŠ¤í”„ë§ì˜ `Application Context` ëŠ” ì¤‘ìš”í•œ ì°¨ì´ê°€ ìˆë‹¤

> ğŸ’¡ ì˜¤ë¸Œì íŠ¸ì˜ ë™ì¼ì„±ê³¼ ë™ë“±ì„±
> - ë™ì¼ì„± (Identical)
>     - ë‘ ê°œì˜ ì˜¤ë¸Œì íŠ¸ê°€ ì™„ì „íˆ ê°™ì€ ì˜¤ë¸Œì íŠ¸
>     - `==` ì—°ì‚°ìë¡œ ë¹„êµí•  ìˆ˜ ìˆë‹¤
>     - ë‘ ê°œì˜ ì˜¤ë¸Œì íŠ¸ê°€ ë™ì¼í•˜ë‹¤ = ì‚¬ì‹¤ì€ í•˜ë‚˜ì˜ ì˜¤ë¸Œì íŠ¸ë§Œ ì¡´ì¬í•˜ê³ , ë‘ ê°œì˜ ì˜¤ë¸Œì íŠ¸ ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ë¥¼ ê°€ì§€ê³  ìˆëŠ” ê²ƒ
> - ë™ë“±ì„± (Equality)
>     - ë‘ ì˜¤ë¸Œì íŠ¸ê°€ ë™ì¼í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆìŒ
>     - `equals` ë©”ì†Œë“œë¡œ ë¹„êµí•œë‹¤
>     - ë‘ ê°œì˜ ì˜¤ë¸Œì íŠ¸ê°€ ë™ì¼í•˜ì§€ëŠ” ì•Šì§€ë§Œ, ê°ê¸° ë‹¤ë¥¸ ì˜¤ë¸Œì íŠ¸ê°€ ë©”ëª¨ë¦¬ìƒì— ì¡´ì¬í•˜ëŠ”ë°, ë™ë“±ì„± ê¸°ì¤€ì— ë”°ë¼ ë‘ ì˜¤ë¸Œì íŠ¸ ì •ë³´ê°€ ë™ë“±í•˜ë‹¤ê³  íŒë‹¨í•œë‹¤
> - ë™ì¼í•œ ì˜¤ë¸Œì íŠ¸ëŠ” ë™ë“±í•˜ê¸°ë„ í•˜ì§€ë§Œ, ê·¸ ë°˜ëŒ€ê°€ í•­ìƒ ì°¸ì€ ì•„ë‹ˆë‹¤


### ì˜¤ë¸Œì íŠ¸ íŒ©í† ë¦¬
```java
DaoFactory factory = new DaoFactory();
UserDao dao1 = factory.userDao();
UserDao dao2 = factory.userDao();

System.out.println(dao1);
System.out.println(dao2);
```

- ë‘ ê°œëŠ” ê°ì ë‹¤ë¥¸ ê°’ì„ ê°€ì§„ ë™ì¼í•˜ì§€ ì•Šì€ ì˜¤ë¸Œì íŠ¸
- `userDao` ë¥¼ ë§¤ë²ˆ í˜¸ì¶œí•  ë•Œ ë§ˆë‹¤ ê³„ì† ìƒˆë¡œìš´ ì˜¤ë¸Œì íŠ¸ê°€ ìƒì„±ëœë‹¤
- ê·¸ë ‡ë‹¤ë©´, ìŠ¤í”„ë§ì€?

### Application Contextì˜ ì˜¤ë¸Œì íŠ¸
```java
ApplicationContext context = new AnnotationConfigApplication(DaoFactory.class);

UserDao dao3 = context.getBean("userDao", UserDAO.class);
UserDao dao4 = context.getBean("userDao", UserDAO.class);

System.out.println(dao3);
System.out.println(dao4);
System.out.println(dao3 == dao4); // true
```

- í•­ìƒ ë‘ ì˜¤ë¸Œì íŠ¸ëŠ” ë™ì¼í•˜ë‹¤
- ìŠ¤í”„ë§ `Application Context` ëŠ” ì—¬ëŸ¬ ë²ˆ Beanì„ ìš”ì²­í•˜ë”ë¼ë„ **ë§¤ë²ˆ ë™ì¼í•œ ì˜¤ë¸Œì íŠ¸ë¥¼ ëŒë ¤ì¤€ë‹¤**
	- ê¸°ë³¸ì ìœ¼ë¡œ Bean ì˜¤ë¸Œì íŠ¸ë¥¼ ëª¨ë‘ `Singleton` ìœ¼ë¡œ ë§Œë“ ë‹¤
- Application ContextëŠ” ì‹±ê¸€í†¤ì„ ì €ì¥í•˜ê³ , ê´€ë¦¬í•˜ëŠ” **Singleton Registry** ì´ë‹¤

## Singleton Pattern
- ì• í”Œë¦¬ì¼€ì´ì…˜ ì•ˆì—ì„œ ì–´ë–¤ í´ë˜ìŠ¤ì˜ ì˜¤ë¸Œì íŠ¸ë¥¼ ì œí•œëœ ì¸ìŠ¤í„´ìŠ¤ ê°œìˆ˜ë§Œ ì¡´ì¬í•˜ë„ë¡ (ì£¼ë¡œ 1ê°œ) ê°•ì œí•˜ëŠ” íŒ¨í„´

### Singleton Patternì˜ íŠ¹ì§•
- Singletonìœ¼ë¡œ ë§Œë“¤ì–´ì§€ëŠ” ì˜¤ë¸Œì íŠ¸ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì—ì„œ ì „ì—­ì ìœ¼ë¡œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤

### Singleton Patternì˜ êµ¬í˜„ ë°©ë²•
1. í´ë˜ìŠ¤ ë°–ì—ì„œëŠ” ì˜¤ë¸Œì íŠ¸ë¥¼ ìƒì„±í•˜ì§€ ëª»í•˜ê²Œ **ìƒì„±ìë¥¼  `private` ** ìœ¼ë¡œ ë§Œë“ ë‹¤
2. ìƒì„±ëœ ì‹±ê¸€í†¤ ì˜¤ë¸Œì íŠ¸ë¥¼ ì €ì¥í•  ìˆ˜ ìˆëŠ” ìì‹ ê³¼ ê°™ì€ íƒ€ì…ì˜ `static` í•„ë“œë¥¼ ì •ì˜í•œë‹¤
3. `static` íŒ©í† ë¦¬ ë©”ì†Œë“œì¸ `getInstance()`  ë¥¼ ë§Œë“¤ê³ , ì´ ë©”ì†Œë“œê°€ ì²˜ìŒ í˜¸ì¶œë˜ë©´, ì˜¤ë¸Œì íŠ¸ë¥¼ ìƒì„±í•˜ê³ , `static` í•„ë“œì— ì €ì¥í•œë‹¤ 
4. í•œ ë²ˆ ì˜¤ë¸Œì íŠ¸ê°€ ë§Œë“¤ì–´ì§€ê³  ë‚œ í›„ì—ëŠ” `getInstance()` ë©”ì†Œë“œ í˜¸ì¶œ ì‹œ, ì´ë¯¸ ë§Œë“¤ì–´ì ¸ì„œ `static` í•„ë“œì— ì €ì¥í•´ë‘” ì˜¤ë¸Œì íŠ¸ë¥¼ ë„˜ê²¨ì¤€ë‹¤

```java
public class UserDAO {
	private static UserDAO INSTANCE;

	private UserDAO(ConnectionMaker connectionMaker) {
		this.connectionMaker = connectionMaker;
	}

	public static synchronized UserDAO getInstace() {
		if (INSTANCE == null) {
			INSTANCE = new UserDAO(???);
		}
		return INSTANCE;
	}
}
```
