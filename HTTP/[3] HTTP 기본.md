# HTTP 웹 기본 지식 - [3] HTTP 기본

### 학습 목표

1. HTTP 를 안다.
2. Stateless에 대해 안다.
3. Connectionless 에 대해 안다.
4. HTTP 메시지에 대해 안다.



## 1. HTTP (HyperText Transfer Protocol)

  HTTP 메시지에 거의 모든 형태의 데이터를 전송하고 받는다. 서버 간에 데이터를 주고 받을 때도 대부분 HTTP를 사용한다. 

- HTTP/0.9 : 1991년, GET 메서드만 지원, HTTP 헤더가 없음
- HTTP/1.0 : 1996년, 메서드, 헤더 추가됨
- HTTP/1.1 : 1997년, 가장 많이 사용되고, 우리에게 가장 중요한 버전임
- HTTP/2 : 2015년, 성능 개선
- HTTP/3 : 진행중, TCP 대신에 UDP를 사용, 성능 개선



### 기반 프로토콜

- TCP : HTTP/1.1, HTTP/2
- UDP : HTTP/3



### HTTP 특징

- 클라이언트 서버 구조
- 무상태 프로토콜 (stateless), 비연결성
- HTTP 메시지
- 단순함, 확장 가능



## 2. HTTP 특징 - Client / Server 구조

- Request / Response 구조
- 클라이언트는 서버에 요청을 보내고, 응답을 대기
- 서버가 요청에 대한 결과를 만들어서 응답



- 클라이언트 - 서버가 개념적으로 분리되어 복잡한 비즈니스 로직은 서버에서만 처리하면 된다
  - 양 쪽이 서로 독립적으로 운영될 수 있다



## 3. HTTP 특징 - Stateless

- 서버가 클라이언트의 상태를 보존하지 않는다
- 장점 : 서버의 확장성이 높다 (scale-out)
- 단점 : 클라이언트가 추가 데이터를 전송



### Stateful - 상태를 유지

```
- 고객 : 이 노트북 얼마인가요?
- 점원 : 100만원 입니다.
======================================
- 고객 : 2개 구매할게요.
- 점원 : 200만원 입니다. 신용카드, 현금 중에 어떤 것으로 구매하실래요?
======================================
- 고객 : 신용카드로 구매하겠습니다.
- 점원 : 200만원 결제 완료 되었습니다.
```

- 만약, 점원이 중간에 바뀐다면?
  - Context를 모르는 점원은 내용을 파악할 수 없음
- 중간에 다른 점원으로 바뀌면 안된다
  - 중간에 다른 점원으로 바뀔 때 상태 정보를 다른 점원에게 미리 알려주어야 한다
- 항상 같은 서버가 유지되어야 해서, 중간에 서버 장애가 난다면 제대로 된 응답을 줄 수가 없다

### Stateless - 상태를 유지 하지 않음

```
- 고객 : 이 노트북 얼마인가요?
- 점원 : 100만원 입니다.
======================================
- 고객 : 노트북 2개 구매할게요.
- 점원 : 노트북 200만원 입니다. 신용카드, 현금 중에 어떤 것으로 구매하실래요?
======================================
- 고객 : 노트북 2개를 신용카드로 구매하겠습니다.
- 점원 : 200만원 결제 완료 되었습니다.
```

- 만약, 점원이 중간에 바뀐다면?
  - 점원이 바뀌어도 바뀐 점원도 내용을 모두 파악할 수 있음
- 갑자기 고객이 증가해도 점원을 대거 투입할 수 있다
- 즉, 클라이언트 요청이 갑자기 증가해도 서버를 대거 투입할 수 있다
- 무상태는 응답 서버를 쉽게 바꿀 수 있다
- 즉, **무한한 서버 증설이 가능하다**는 장점을 가진다
- 갑자기 서버 장애가 난다고 해도, 다른 서버가 요청에 대한 응답을 줄 수 있다
- Scale out (수평 확장) 에 굉장히 유리하다



### Stateless의 한계

- 모든 것을 무상태로 설계 할 수 있는 경우도 있고, 없는 경우도 있다
- 무상태
  - ex) 로그인이 필요 없는 단순한 서비스 소개 화면
- 상태 유지
  - ex) 로그인
- 로그인 한 사용자의 경우 로그인했다는 상태를 서버에 유지
- 일반적으로 브라우저 쿠키와 서버 세션을 이용하여 상태를 유지한다
- 상태 유지는 최소한만 사용한다



## 4. HTTP 특징 - 비 연결성 (Connectionless)

### 연결을 유지하는 모델

- 서버는 연결을 계속 유지하므로 연결이 유지 되는 동안 서버 자원을 계속적으로 소모해야 한다

### 연결을 유지 하지 않는 모델

- 서버는 연결을 유지하지 않아도 되므로, 최소한의 자원으로 서버를 운영할 수 있다



### 비 연결성

- HTTP는 기본이 연결을 유지하지 않는 모델
- 일반적으로 초 단위의 이하의 빠른 속도로 응답함
- 1시간 동안 수천명이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십개 이하로 매우 작다
  - ex) 웹 브라우저에서 계속 연속해서 검색 버튼을 누르지는 않는다
- 서버 자원을 매우 효율적으로 사용할 수 있다



### 비 연결성의 한계와 극복

#### 한계점

- TCP/IP 연결을 새로 맺어야 한다 - 그에 따라, 3 way handshake 시간이 추가됨
- 웹 브라우저 사이트를 요청하면 HTML 뿐만 아니라 자바스크립트, css, 추가 이미지 등 수 많은 자원이 함께 다운로드된다
  - 연결을 새로 할 때 마다 다운로드 됨

#### 극복

- 지금은 HTTP 지속 연결 (Persistent Connections) 로 문제를 해결함
- HTTP/2, HTTP/3에서 더 많은 최적화를 함



#### HTTP 지속 연결 (Persistent Connections)

- 연결을 새로 하고, HTML 페이지를 다 만들 때 까지 연결을 끊지 않는다



## 5. HTTP 메시지

### HTTP 메시지 구조

- start-line
- header
- empty line (CRLF)
- message body



#### HTTP Request Message

- start-line = request-line  / status-line
- request-line = method SP(공백) request-target SP HTTP-version CRLF (엔터)



- HTTP 메서드
  - 종류 : GET, POST, PUT, DELETE
  - **서버가 수행해야 할 동작 지정**
- 요청 대상
  - absolute-path[?query] (절대경로[?쿼리])
  - 절대경로
    - "/"로 시작하는 경로
- HTTP Version



#### HTTP Response Message

- start-line = request-line / status-line
- status-line = HTTP-version SP status-code SP reason-phrase CRLF
- HTTP 버전
- HTTP 상태 코드
  - 요청 성공, 실패를 나타냄
    - 200 : 성공
    - 400 : 클라이언트 요청 오류
    - 500 : 서버 내부 오류
- 이유 문구
  - 사람이 이해할 수 있는 짧은 상태 코드 설명 글



#### HTTP 헤더

- header-field = field-name ":" OWS field-vale OWS (OWS : 띄어쓰기 허용)
- HTTP 전송에 필요한 모든 부가정보
- ex) 메시지 바디의 내용, 메시지 바디의 크기, 압축, 인증, 요청 클라이언트 (브라우저) 정보, 서버 애플리케이션 정보, 캐시 관리 정보...
- 표준 헤더가 너무 많음
- 필요 시 임의의 헤더 추가 가능
  - helloworld: hihi



#### HTTP Message Body

- 실제 전송할 데이터
- HTML 문서, 이미지, 영상, JSON 등등 byte로 표현할 수 있는 모든 데이터 전송 가능



### 출처

[인프런  - 김영한님의 모든 개발자를 위한 HTTP 웹 기본 지식]: https://www.inflearn.com/course/http-%EC%9B%B9-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC/dashboard	"김영한님의 모든 개발자를 위한 HTTP 웹 기본 지식"

